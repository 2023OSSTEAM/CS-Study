### 4.3.1 트랜잭션

트랜잭션은 데이터베이스에서 하나의 논리적 기능을 수행하기 위한 작업의 단위를 말하며 데이터베이스에 접근하는 방법은 쿼리이므로, 즉 여러 개의 쿼리들을 하나로 묶는 단위를 말합니다. 

ACID

- Atomicity
- Consistency
- Isolation
- Durability

---

https://www.youtube.com/watch?v=e9PC0sroCzc&ab_channel=%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC

#### Atomicity

트랜잭션은 DB에 모두 반영되거나, 전혀 반영되지 않아야 한다.

commit 과 rollback으로 관리한다.

##### 트랜잭션 전파

![](attachments/Pasted%20image%2020230303145558.png)

---

#### Consistency

트랜잭션의 작업처리결과는 항상 일관성 있어야 한다.
데이터베이스는 항상 일관된 상태로 유지되어야 한다.

무슨 뜻일까?

허용된 방식으로만 데이터를 변경해야 하는 것을 의미한다.
여러 가지 조건, 규칙에 따라 유효함을 가져야 합니다.

---

#### Isolation

둘 이상의 트랜잭션이 동시 실행되고 있을 때, 어떤 트랜잭션도 다른 트랜잭션 연산에 개입할 수 없다.
(= 각각의 트랜잭션은 서로 간섭 없이 독립적으로 이루어져야 한다.)

##### READ_UNCOMMITED

커밋 전의 트랜잭션의 데이터 변경 내용을 다른 트랜잭션이 읽는 것을 허용한다.

![](attachments/Pasted%20image%2020230303145133.png)

##### READ_COMMITED

커밋이 완료된 트랜잭션의 변경사항만 다른 트랜잭션에서 조회 가능

![](attachments/Pasted%20image%2020230303145213.png)

##### REPEATABLE_READ

![](attachments/Pasted%20image%2020230303145239.png)

Non-repeatable read 와 Phantom read의 차이는 무엇인가?

팬텀 리드: 조회해온 결과의 행이 새로 생기거나 없어지는 현상

##### SERIALIZABLE

한 트랜잭션에서 사용하는 데이터를 다른 트랜잭션에서 접근 불가

![](attachments/Pasted%20image%2020230303145433.png)

---

#### Durability

트랜잭션이 성공하면 결과는 영구히 반영되어야 한다.

시스템 장애가 발생해도 원래 상태로 복구하는 회복 기능이 있어야 합니다. 체크섬, 저널링, 롤백 등의 기능을 제공합니다.

#### 저널링

파일 시스템 또는 데이터베이스 시스템에 변경 사항을 반영하기 전에 로깅하는 것. 트랜잭션 등 변경 사항에 대한 로그를 남기는 것.

---

### 4.3.2 무결성

데이터의 정확성, 일관성, 유효성을 유지하는 것을 말한다.

- 개체 무결성: 기본키로 선택된 필드는 빈 값을 허용하지 않는다.
- 참조 무결성: 서로 참조 관계에 있는 두 테이블의 데이터는 항상 일관된 값을 유지한다.
- 고유 무결성: 특정 속성에 대해 고유한 값을 가지도록 조건이 주어지면 그렇게 한다.
- NULL 무결성: 특정 속성 값이 NULL이 올 수 없다는 제약 조건.